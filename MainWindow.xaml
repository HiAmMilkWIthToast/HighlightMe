<Window x:Class="HighlightMe.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:HighlightMe.ViewModels"
        xmlns:converters="clr-namespace:HighlightMe.Converters"
        Title="HighlightMe - Desktop Scanner"
        Height="870" Width="1686"
        MinHeight="870" MinWidth="1686"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource PrimaryBackgroundBrush}">
    
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    
    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:BoolToHighlightThicknessConverter x:Key="BoolToHighlightThicknessConverter"/>
        <converters:CountToVisibilityConverter x:Key="CountToVisibilityConverter"/>
        <converters:IntToThicknessConverter x:Key="IntToThicknessConverter"/>
        
        <!-- Item Card Style -->
        <Style x:Key="ItemCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource CardGradientBrush}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{DynamicResource HighlightBackgroundBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Padding="30,25" Background="{DynamicResource HeaderGradientBrush}">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*" MinWidth="250"/>
                    <ColumnDefinition Width="Auto"/> <!-- Sort -->
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/> <!-- Settings -->
                    <ColumnDefinition Width="Auto"/> <!-- Help -->
                </Grid.ColumnDefinitions>
                
                <!-- Title -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ” HighlightMe" 
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="{StaticResource TextPrimaryBrush}"/>
                    <TextBlock Text="Find files on your desktop instantly" 
                               FontSize="13" 
                               Foreground="{StaticResource TextSecondaryBrush}"
                               Margin="0,5,0,0"/>
                </StackPanel>
                
                <!-- Search Box with History -->
                <Grid Grid.Column="1" Margin="40,0"
                      ToolTip="Type to search for files by name. Use the dropdown to see recent searches.">
                    <ComboBox x:Name="SearchComboBox"
                              Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                              ItemsSource="{Binding SearchHistory}"
                              IsEditable="True"
                              IsTextSearchEnabled="False"
                              StaysOpenOnEdit="True"
                              VerticalAlignment="Center"
                              Background="#2A2A4A"
                              Foreground="{StaticResource TextPrimaryBrush}"
                              BorderBrush="#3A3A5A"
                              BorderThickness="2"
                              Padding="15,12"
                              FontSize="16">
                        <ComboBox.Resources>
                            <SolidColorBrush x:Key="{x:Static SystemColors.WindowBrushKey}" Color="#2A2A4A"/>
                            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#3D5A80"/>
                        </ComboBox.Resources>
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="{Binding}" 
                                               Foreground="{StaticResource TextPrimaryBrush}"
                                               VerticalAlignment="Center"
                                               Margin="5,5"/>
                                    <Button Grid.Column="1" Content="âœ•" 
                                            Command="{Binding DataContext.RemoveHistoryItemCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"
                                            Background="Transparent"
                                            Foreground="#808080"
                                            BorderThickness="0"
                                            Padding="8,2"
                                            Cursor="Hand"
                                            FontSize="10"/>
                                </Grid>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                        <ComboBox.Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBox">
                                            <Grid>
                                                <Border x:Name="border" 
                                                        Background="{TemplateBinding Background}" 
                                                        BorderBrush="{TemplateBinding BorderBrush}" 
                                                        BorderThickness="{TemplateBinding BorderThickness}" 
                                                        CornerRadius="12"
                                                        SnapsToDevicePixels="True">
                                                    <Border.Effect>
                                                        <DropShadowEffect BlurRadius="10" ShadowDepth="0" Opacity="0.3" Color="#000000"/>
                                                    </Border.Effect>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBox x:Name="PART_EditableTextBox"
                                                                 Grid.Column="0"
                                                                 Text="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}"
                                                                 Background="Transparent"
                                                                 BorderThickness="0"
                                                                 Foreground="{StaticResource TextPrimaryBrush}"
                                                                 CaretBrush="{StaticResource AccentBrush}"
                                                                 Padding="10,0"
                                                                 VerticalAlignment="Center"
                                                                 FontSize="16"/>
                                                        <ToggleButton Grid.Column="1"
                                                                      IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                                      Background="Transparent"
                                                                      BorderThickness="0"
                                                                      Padding="10,0"
                                                                      Cursor="Hand">
                                                            <TextBlock Text="â–¼" Foreground="#606080" FontSize="10"/>
                                                        </ToggleButton>
                                                    </Grid>
                                                </Border>
                                                <Popup x:Name="PART_Popup"
                                                       AllowsTransparency="True"
                                                       IsOpen="{TemplateBinding IsDropDownOpen}"
                                                       Placement="Bottom"
                                                       PopupAnimation="Slide">
                                                    <Border Background="#1E2A4A"
                                                            BorderBrush="#3A3A5A"
                                                            BorderThickness="1"
                                                            CornerRadius="8"
                                                            Margin="0,5,0,0"
                                                            MaxHeight="300"
                                                            MinWidth="{TemplateBinding ActualWidth}">
                                                        <Border.Effect>
                                                            <DropShadowEffect BlurRadius="15" ShadowDepth="3" Opacity="0.5"/>
                                                        </Border.Effect>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="*"/>
                                                            </Grid.RowDefinitions>
                                                            <TextBlock Grid.Row="0" Text="ðŸ• Recent Searches" 
                                                                       Foreground="#808090" FontSize="11"
                                                                       Margin="12,8,12,5"/>
                                                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                                                <ItemsPresenter/>
                                                            </ScrollViewer>
                                                        </Grid>
                                                    </Border>
                                                </Popup>
                                            </Grid>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsFocused" Value="True">
                                                    <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.Style>
                    </ComboBox>
                    <TextBlock Text="ðŸ”Ž Type to search..."
                               FontSize="16"
                               Foreground="#606080"
                               VerticalAlignment="Center"
                               Margin="25,0,0,0"
                               IsHitTestVisible="False">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SearchQuery}" Value="">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    
                    <!-- Search In Contents Toggle -->
                    <ToggleButton HorizontalAlignment="Right" 
                                  VerticalAlignment="Center"
                                  Margin="0,0,5,0"
                                  IsChecked="{Binding SearchInContents}"
                                  Background="Transparent"
                                  BorderThickness="0"
                                  ToolTip="Search inside text file contents (files under 1MB). When ON, finds files containing your search term, not just matching filenames.">
                        <TextBlock Text="ðŸ“„" FontSize="16">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="#606080"/> <!-- Default/Unchecked color -->
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SearchInContents}" Value="True">
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType=ToggleButton}}" Value="True">
                                            <Setter Property="Foreground" Value="#E0E0E0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                        <ToggleButton.Style>
                            <Style TargetType="ToggleButton">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ToggleButton">
                                            <Border Background="{TemplateBinding Background}" Padding="5">
                                                <ContentPresenter/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter Property="Background" Value="#3D5A80"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>
                    </ToggleButton>
                </Grid>
                
                <!-- Sort Dropdown -->
                <ComboBox Grid.Column="2"
                          ItemsSource="{Binding SortOptions}" 
                          SelectedItem="{Binding SortBy}"
                          Width="110" 
                          FontSize="13"
                          Foreground="White"
                          VerticalAlignment="Center"
                          Margin="0,0,15,0"
                          BorderBrush="#3A3A5A"
                          BorderThickness="2"
                          ToolTip="Sort files by Name, Date Modified, Size, or File Type">
                        <ComboBox.Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBox">
                                            <Grid>
                                                <ToggleButton x:Name="ToggleButton"
                                                            Grid.Column="2"
                                                            Focusable="false"
                                                            IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                            ClickMode="Press">
                                                    <ToggleButton.Template>
                                                        <ControlTemplate TargetType="ToggleButton">
                                                            <Border Background="#2A2A4A" 
                                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                                    CornerRadius="10">
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition/>
                                                                        <ColumnDefinition Width="20"/>
                                                                    </Grid.ColumnDefinitions>
                                                                    <ContentPresenter Grid.Column="0" Margin="6,5"/>
                                                                    <Path Grid.Column="1" 
                                                                          Data="M 0 0 L 4 4 L 8 0 Z"
                                                                          Fill="White"
                                                                          HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                                </Grid>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </ToggleButton.Template>
                                                </ToggleButton>
                                                <ContentPresenter x:Name="ContentSite"
                                                                IsHitTestVisible="False"
                                                                Content="{TemplateBinding SelectionBoxItem}"
                                                                ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                                Margin="8,5,25,5"
                                                                VerticalAlignment="Center"
                                                                HorizontalAlignment="Left"/>
                                                <Popup x:Name="Popup"
                                                       Placement="Bottom"
                                                       IsOpen="{TemplateBinding IsDropDownOpen}"
                                                       AllowsTransparency="True"
                                                       Focusable="False"
                                                       PopupAnimation="Slide">
                                                    <Grid x:Name="DropDown"
                                                          SnapsToDevicePixels="True"
                                                          MinWidth="{TemplateBinding ActualWidth}"
                                                          MaxHeight="200">
                                                        <Border Background="#2A2A4A" 
                                                                BorderBrush="#3A3A5A" 
                                                                BorderThickness="1"
                                                                CornerRadius="5"
                                                                Margin="0,2,0,0">
                                                            <ScrollViewer Margin="4,6" SnapsToDevicePixels="True">
                                                                <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                                            </ScrollViewer>
                                                        </Border>
                                                    </Grid>
                                                </Popup>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.Style>
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Padding" Value="8,4"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBoxItem">
                                            <Border Background="{TemplateBinding Background}" 
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsHighlighted" Value="True">
                                                    <Setter Property="Background" Value="#3D5A80"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#4A6FA5"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.ItemContainerStyle>
                </ComboBox>
                
                <!-- Desktop Highlight Toggle -->
                <ToggleButton Grid.Column="3"
                              IsChecked="{Binding ShowDesktopHighlights}"
                              VerticalAlignment="Center"
                              Margin="0,0,15,0"
                              Cursor="Hand"
                              ToolTip="Creates glowing highlight effects on your actual Windows desktop icons that match your search. Turn ON to visually find files faster!">
                    <ToggleButton.Template>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border x:Name="border" 
                                    Background="#2A2A4A" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="#3A3A5A">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="icon" Text="ðŸ–¥ï¸" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock x:Name="text" Text="Desktop Glow" 
                                               Foreground="#A0A0A0" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3D5A80"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#FFD700"/>
                                    <Setter TargetName="text" Property="Foreground" Value="#FFD700"/>
                                    <Setter TargetName="icon" Property="Text" Value="âœ¨"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3A3A5A"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </ToggleButton.Template>
                </ToggleButton>
                
                <!-- New Item Toggle -->
                <ToggleButton Grid.Column="4"
                              IsChecked="{Binding ShowNewItemHighlights}"
                              VerticalAlignment="Center"
                              Margin="0,0,15,0"
                              Cursor="Hand"
                              ToolTip="Highlight recently added files. When ON, new files since your last scan show a red badge so you can quickly spot what's new on your desktop.">
                    <ToggleButton.Template>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border x:Name="border" 
                                    Background="#2A2A4A" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="#3A3A5A">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="icon" Text="ðŸ“¦" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock x:Name="text" Text="New Items" 
                                               Foreground="#A0A0A0" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#5A2A2A"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#FF3333"/>
                                    <Setter TargetName="text" Property="Foreground" Value="#FF3333"/>
                                    <Setter TargetName="icon" Property="Text" Value="ðŸ”´"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3A3A5A"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </ToggleButton.Template>
                </ToggleButton>
                
                <!-- Arrow Toggle -->
                <ToggleButton Grid.Column="5"
                              IsChecked="{Binding ShowArrows}"
                              VerticalAlignment="Center"
                              Margin="0,0,15,0"
                              Cursor="Hand"
                              ToolTip="Show animated bouncing arrows pointing to matching files on your desktop. Great for quickly locating files visually!">
                    <ToggleButton.Template>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border x:Name="border" 
                                    Background="#2A2A4A" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="#3A3A5A">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="icon" Text="â†—ï¸" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock x:Name="text" Text="Arrows" 
                                               Foreground="#A0A0A0" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#2A5A2A"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#33FF33"/>
                                    <Setter TargetName="text" Property="Foreground" Value="#33FF33"/>
                                    <Setter TargetName="icon" Property="Text" Value="âœ¨"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3A3A5A"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </ToggleButton.Template>
                </ToggleButton>
                
                <!-- Category Manager Button -->
                <Button Grid.Column="6"
                        Command="{Binding OpenColorSettingsCommand}"
                        ToolTip="Customize highlight colors for different file types (Documents, Images, Videos, Audio, etc.). Make each category stand out with your preferred colors."
                        Cursor="Hand"
                        VerticalAlignment="Center"
                        Margin="0,0,15,0">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" 
                                    Background="#2A2A4A" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="#3A3A5A">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸŽ¨" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Categories" 
                                               Foreground="#A0A0A0" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3A3A5A"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
                
                <!-- View Toggle Button -->
                <ToggleButton Grid.Column="7"
                              IsChecked="{Binding IsListView}"
                              VerticalAlignment="Center"
                              Margin="0,0,10,0"
                              Cursor="Hand"
                              ToolTip="Switch between Grid view (visual cards with icons) and List view (detailed table with file info)">
                    <ToggleButton.Template>
                        <ControlTemplate TargetType="ToggleButton">
                            <Border x:Name="border" 
                                    Background="#2A2A4A" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="#3A3A5A">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="icon" Text="ðŸ“" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock x:Name="text" Text="Grid" 
                                               Foreground="#A0A0A0" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="icon" Property="Text" Value="ðŸ“‹"/>
                                    <Setter TargetName="text" Property="Text" Value="List"/>
                                    <Setter TargetName="border" Property="Background" Value="#3D5A80"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#4A6FA5"/>
                                    <Setter TargetName="text" Property="Foreground" Value="#4A6FA5"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3A3A5A"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </ToggleButton.Template>
                </ToggleButton>
                
                <!-- Refresh Button -->
                <Button Grid.Column="8"
                        Content="â†» Refresh"
                        Command="{Binding RefreshCommand}"
                        Style="{StaticResource ModernButtonStyle}"
                        ToolTip="Rescan your desktop folder for new, modified, or deleted files. Use this after adding or removing files."
                        VerticalAlignment="Center"
                        Margin="0,0,10,0"/>
                
                <!-- Settings Button -->
                <Button Grid.Column="9"
                        Command="{Binding OpenAppSettingsCommand}"
                        ToolTip="Open settings to customize themes (Dark/Light/Midnight), card sizes, icon sizes, and other appearance options."
                        Cursor="Hand"
                        VerticalAlignment="Center">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" 
                                    Background="{DynamicResource InputBackgroundBrush}" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="{DynamicResource InputBorderBrush}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="âš™ï¸" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Settings" 
                                               Foreground="{DynamicResource TextSecondaryBrush}" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="{DynamicResource InputBorderBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
                
                <!-- Help Button -->
                <Button Grid.Column="10"
                        Command="{Binding OpenHelpCommand}"
                        ToolTip="Open the user guide to learn how to use all features of HighlightMe."
                        Cursor="Hand"
                        VerticalAlignment="Center"
                        Margin="10,0,0,0">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" 
                                    Background="#2A5A2A" 
                                    CornerRadius="10" 
                                    Padding="15,10"
                                    BorderThickness="2"
                                    BorderBrush="#3A7A3A">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="â“" FontSize="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Help" 
                                               Foreground="#90EE90" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#3A6A3A"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </Grid>
        </Border>
        
        <!-- Stats Bar -->
        <Border Grid.Row="1" Background="{DynamicResource TertiaryBackgroundBrush}" Padding="30,12">
            <StackPanel Orientation="Horizontal">
                <TextBlock Foreground="{DynamicResource TextSecondaryBrush}" FontSize="14">
                    <Run Text="ðŸ“"/>
                    <Run Text="{Binding TotalItems, Mode=OneWay}"/>
                    <Run Text="total items"/>
                </TextBlock>
                <TextBlock Text="  â€¢  " Foreground="{DynamicResource SeparatorBrush}" FontSize="14"/>
                <TextBlock Foreground="{DynamicResource AccentLightBrush}" FontSize="14">
                    <Run Text="âœ¨"/>
                    <Run Text="{Binding MatchingItems, Mode=OneWay}"/>
                    <Run Text="matching"/>
                </TextBlock>
                <TextBlock Text="  â€¢  " Foreground="{DynamicResource SeparatorBrush}" FontSize="14"/>
                <TextBlock Foreground="{DynamicResource HighlightGlowBrush}" FontSize="14">
                    <Run Text="ðŸ–¥ï¸"/>
                    <Run Text="{Binding DesktopHighlightCount, Mode=OneWay}"/>
                    <Run Text="glowing"/>
                </TextBlock>
                <TextBlock Text="  â€¢  " Foreground="{DynamicResource SeparatorBrush}" FontSize="14"/>
                <TextBlock Foreground="#FF3333" FontSize="14">
                    <Run Text="ðŸ”´"/>
                    <Run Text="{Binding NewItemCount, Mode=OneWay}"/>
                    <Run Text="new"/>
                </TextBlock>
            </StackPanel>
        </Border>
        
        <!-- New Item Notification Bar -->
        <Border Grid.Row="2" Background="#3D1A1A" Padding="20,10"
                Visibility="{Binding NewItemCount, Converter={StaticResource CountToVisibilityConverter}}">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ”´" FontSize="14" Margin="0,0,10,0"/>
                    <TextBlock Text="{Binding NewItemNotification}" 
                               Foreground="#FF6666" FontSize="13" VerticalAlignment="Center"/>
                </StackPanel>
                <Button Content="âœ• Clear All" 
                        Command="{Binding ClearNewItemsCommand}"
                        HorizontalAlignment="Right"
                        Background="#FF3333"
                        Foreground="White"
                        BorderThickness="0"
                        Padding="12,5"
                        Cursor="Hand">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" 
                                    CornerRadius="5" 
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </Grid>
        </Border>
        
        <!-- Items Grid View -->
        <ScrollViewer Grid.Row="3" 
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="20,10"
                      Visibility="{Binding IsListView, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}">
            <ItemsControl ItemsSource="{Binding DesktopItems}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                
                <ItemsControl.ItemTemplate>
                        <DataTemplate>
                        <Border Style="{StaticResource ItemCardStyle}"
                                Width="{Binding DataContext.CardWidth, RelativeSource={RelativeSource AncestorType=Window}}"
                                Margin="{Binding DataContext.CardMargin, RelativeSource={RelativeSource AncestorType=Window}}"
                                Opacity="{Binding Opacity}"
                                BorderBrush="{DynamicResource HighlightGlowBrush}"
                                BorderThickness="{Binding IsHighlighted, Converter={StaticResource BoolToHighlightThicknessConverter}}">
                            
                            <!-- Context Menu -->
                            <Border.ContextMenu>
                                <ContextMenu Background="#1E2A4A" BorderBrush="#3A3A5A" BorderThickness="1">
                                    <MenuItem Header="ðŸ“‚ Open" 
                                              Command="{Binding DataContext.OpenItemCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                              CommandParameter="{Binding}"
                                              Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <MenuItem Header="ðŸ‘ï¸ Preview" 
                                              Click="PreviewMenuItem_Click"
                                              Foreground="{StaticResource TextPrimaryBrush}"
                                              ToolTip="Preview text or image files"/>
                                    <MenuItem Header="ðŸ“ Open File Location" 
                                              Command="{Binding DataContext.OpenLocationCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                              CommandParameter="{Binding}"
                                              Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <Separator Background="#3A3A5A"/>
                                    <MenuItem Header="ðŸ“‹ Copy Path" 
                                              Click="CopyPathMenuItem_Click"
                                              Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <Separator Background="#3A3A5A"/>
                                    <MenuItem Header="ðŸ“ Add/Edit Note" 
                                              Click="AddEditNoteMenuItem_Click"
                                              Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <Separator Background="#3A3A5A"/>
                                    <MenuItem Header="ðŸ‘» Hide/Unhide" 
                                              Click="ToggleHiddenMenuItem_Click"
                                              Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <MenuItem Header="ðŸ”’ Lock/Unlock" 
                                              Click="ToggleLockMenuItem_Click"
                                              Foreground="{StaticResource TextPrimaryBrush}"
                                              ToolTip="Lock file to prevent deletion"/>
                                </ContextMenu>
                            </Border.ContextMenu>
                            
                            <Border.InputBindings>
                                <MouseBinding MouseAction="LeftDoubleClick"
                                              Command="{Binding DataContext.OpenItemCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="{Binding}"/>
                            </Border.InputBindings>
                            
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="12" 
                                                  ShadowDepth="3" 
                                                  Opacity="0.4" 
                                                  Color="#000000"/>
                            </Border.Effect>
                            
                            <!-- Highlight Glow Effect -->
                            <Border.Triggers>
                                <EventTrigger RoutedEvent="Border.MouseEnter">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <!-- Card Scale Animation -->
                                            <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                             To="1.03" Duration="0:0:0.15"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                             To="1.03" Duration="0:0:0.15"/>
                                            
                                            <!-- Quick Open Badge Fade In -->
                                            <DoubleAnimation Storyboard.TargetName="QuickOpenBadge"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="1" Duration="0:0:0.2"/>
                                            
                                            <!-- Bounce Animation for the Badge -->
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="QuickOpenBadge"
                                                                           Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                                                                           RepeatBehavior="Forever">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="-5">
                                                    <EasingDoubleKeyFrame.EasingFunction>
                                                        <QuadraticEase EasingMode="EaseOut"/>
                                                    </EasingDoubleKeyFrame.EasingFunction>
                                                </EasingDoubleKeyFrame>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.6" Value="0">
                                                    <EasingDoubleKeyFrame.EasingFunction>
                                                        <BounceEase EasingMode="EaseOut" Bounces="2" Bounciness="4"/>
                                                    </EasingDoubleKeyFrame.EasingFunction>
                                                </EasingDoubleKeyFrame>
                                                <EasingDoubleKeyFrame KeyTime="0:0:1.2" Value="0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <EventTrigger RoutedEvent="Border.MouseLeave">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <!-- Card Scale Animation -->
                                            <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                             To="1.0" Duration="0:0:0.15"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                             To="1.0" Duration="0:0:0.15"/>
                                            
                                            <!-- Quick Open Badge Fade Out -->
                                            <DoubleAnimation Storyboard.TargetName="QuickOpenBadge"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="0" Duration="0:0:0.15"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Border.Triggers>
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Icon -->
                                <Grid Grid.Row="0" HorizontalAlignment="Center" Margin="0,5,0,10">
                                    <Ellipse Width="70" Height="70" Fill="#0A1628"/>
                                    <Image Source="{Binding Icon}" 
                                           Width="40" Height="40"
                                           RenderOptions.BitmapScalingMode="HighQuality"/>
                                    
                                    <!-- Highlight Indicator -->
                                    <Ellipse Width="76" Height="76"
                                             Stroke="{StaticResource HighlightGlowBrush}"
                                             StrokeThickness="3"
                                             Visibility="{Binding IsHighlighted, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <Ellipse.Effect>
                                            <BlurEffect Radius="5"/>
                                        </Ellipse.Effect>
                                    </Ellipse>
                                    
                                    <!-- Note Indicator Badge -->
                                    <Border Visibility="{Binding HasNote, Converter={StaticResource BoolToVisibilityConverter}}"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Margin="0,-5,-5,0"
                                            Background="#FFEB3B"
                                            CornerRadius="10"
                                            Padding="6,2"
                                            ToolTip="{Binding NoteText}">
                                        <TextBlock Text="ðŸ“" FontSize="10"/>
                                    </Border>
                                    
                                    <!-- Hidden File Ghost Indicator with Glow -->
                                    <Border Visibility="{Binding IsHidden, Converter={StaticResource BoolToVisibilityConverter}}"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Width="80" Height="80"
                                            CornerRadius="40"
                                            BorderThickness="3"
                                            BorderBrush="#9E9E9E"
                                            Background="Transparent"
                                            ToolTip="ðŸ‘» This file is HIDDEN - not visible on desktop">
                                        <Border.Effect>
                                            <DropShadowEffect Color="#9E9E9E" BlurRadius="15" ShadowDepth="0" Opacity="0.8"/>
                                        </Border.Effect>
                                    </Border>
                                    
                                    <!-- Ghost Badge -->
                                    <Border Visibility="{Binding IsHidden, Converter={StaticResource BoolToVisibilityConverter}}"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Margin="-5,-5,0,0"
                                            Background="#9E9E9E"
                                            CornerRadius="10"
                                            Padding="6,2"
                                            ToolTip="ðŸ‘» HIDDEN - Right-click â†’ Hide/Unhide to show on desktop">
                                        <TextBlock Text="ðŸ‘»" FontSize="10"/>
                                    </Border>
                                    
                                    <!-- Lock Indicator with Gold Glow -->
                                    <Border Visibility="{Binding IsLocked, Converter={StaticResource BoolToVisibilityConverter}}"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Bottom"
                                            Width="80" Height="80"
                                            CornerRadius="40"
                                            BorderThickness="3"
                                            BorderBrush="#FFD700"
                                            Background="Transparent"
                                            ToolTip="ðŸ”’ LOCKED - Cannot be deleted">
                                        <Border.Effect>
                                            <DropShadowEffect Color="#FFD700" BlurRadius="15" ShadowDepth="0" Opacity="0.8"/>
                                        </Border.Effect>
                                    </Border>
                                    
                                    <!-- Lock Badge -->
                                    <Border Visibility="{Binding IsLocked, Converter={StaticResource BoolToVisibilityConverter}}"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Bottom"
                                            Margin="0,0,-5,40"
                                            Background="#FFD700"
                                            CornerRadius="10"
                                            Padding="6,2"
                                            ToolTip="ðŸ”’ LOCKED - Right-click â†’ Lock/Unlock to unprotect">
                                        <TextBlock Text="ðŸ”’" FontSize="10"/>
                                    </Border>
                                    
                                    <!-- âœ¨ FUN Quick Open Action Badge - Appears on hover! âœ¨ -->
                                    <Border x:Name="QuickOpenBadge"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Bottom"
                                            Margin="0,0,0,-12"
                                            Background="#2A5A50"
                                            BorderBrush="#4CAF50"
                                            BorderThickness="2"
                                            CornerRadius="15"
                                            Padding="10,4"
                                            Opacity="0"
                                            ToolTip="{Binding OpenActionHint}"
                                            RenderTransformOrigin="0.5,0.5">
                                        <Border.RenderTransform>
                                            <TranslateTransform x:Name="BadgeTranslate" Y="0"/>
                                        </Border.RenderTransform>
                                        <Border.Effect>
                                            <DropShadowEffect Color="#4CAF50" BlurRadius="10" ShadowDepth="0" Opacity="0.6"/>
                                        </Border.Effect>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding OpenActionEmoji}" FontSize="12" Margin="0,0,4,0"/>
                                            <TextBlock Text="Double-Click!" 
                                                       Foreground="#4CAF50" 
                                                       FontSize="10" 
                                                       FontWeight="Bold"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                                
                                <!-- Name -->
                                <TextBlock Grid.Row="1" 
                                           Text="{Binding Name}"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           FontSize="13"
                                           FontWeight="SemiBold"
                                           TextTrimming="CharacterEllipsis"
                                           TextAlignment="Center"
                                           ToolTip="{Binding Name}"
                                           MaxWidth="180"/>
                                
                                <!-- Info -->
                                <StackPanel Grid.Row="2" Margin="0,8,0,0" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding FormattedSize}"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               FontSize="11"
                                               TextAlignment="Center"/>
                                    <TextBlock Text="{Binding TypeDescription}"
                                               Foreground="#505070"
                                               FontSize="10"
                                               TextAlignment="Center"
                                               Margin="0,2,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        
        <!-- âœ¨ Fun Animated Footer with Tips âœ¨ -->
        <Border Grid.Row="4" Background="#0A0A1A" Padding="20,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Fun Tips Carousel -->
                <Border Grid.Column="0" 
                        Background="#1A2A40" 
                        CornerRadius="20" 
                        Padding="15,8"
                        BorderBrush="#2A4A60"
                        BorderThickness="1">
                    <Border.Effect>
                        <DropShadowEffect Color="#4CAF50" BlurRadius="8" ShadowDepth="0" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’¡" FontSize="14" Margin="0,0,8,0" VerticalAlignment="Center">
                            <TextBlock.RenderTransform>
                                <ScaleTransform x:Name="TipIconScale" ScaleX="1" ScaleY="1"/>
                            </TextBlock.RenderTransform>
                            <TextBlock.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation Storyboard.TargetName="TipIconScale"
                                                             Storyboard.TargetProperty="ScaleX"
                                                             From="1" To="1.2" Duration="0:0:0.5"
                                                             AutoReverse="True"/>
                                            <DoubleAnimation Storyboard.TargetName="TipIconScale"
                                                             Storyboard.TargetProperty="ScaleY"
                                                             From="1" To="1.2" Duration="0:0:0.5"
                                                             AutoReverse="True"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </TextBlock.Triggers>
                        </TextBlock>
                        <TextBlock Foreground="#A0B0C0" FontSize="12" VerticalAlignment="Center">
                            <Run Text="ðŸ“‚ Folders" Foreground="#FFD700"/>
                            <Run Text=" â€¢ "/>
                            <Run Text="ðŸ“ Text Files" Foreground="#4CAF50"/>
                            <Run Text=" â€¢ "/>
                            <Run Text="ðŸ–¼ï¸ Images" Foreground="#2196F3"/>
                            <Run Text=" â†’ Double-click to open instantly!" Foreground="#A0B0C0"/>
                        </TextBlock>
                    </StackPanel>
                </Border>
                
                <!-- Center: Hover Hint -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="âœ¨ Hover over items to see the" 
                               Foreground="#606070" 
                               FontSize="11"
                               VerticalAlignment="Center"/>
                    <Border Background="#2A5A50" 
                            CornerRadius="10" 
                            Padding="8,3" 
                            Margin="5,0"
                            BorderBrush="#4CAF50"
                            BorderThickness="1">
                        <TextBlock Text="Double-Click!" 
                                   Foreground="#4CAF50" 
                                   FontSize="10" 
                                   FontWeight="Bold"/>
                    </Border>
                    <TextBlock Text="badge!" 
                               Foreground="#606070" 
                               FontSize="11"
                               VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- Version -->
                <TextBlock Grid.Column="2"
                           Text="HighlightMe v1.0"
                           Foreground="#404050"
                           FontSize="11"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>
        
        <!-- Loading Overlay -->
        <Border Grid.RowSpan="5"
                Background="#CC1A1A2E"
                Visibility="{Binding IsScanning, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="â³" FontSize="48" HorizontalAlignment="Center"/>
                <TextBlock Text="Scanning Desktop..."
                           Foreground="{StaticResource TextPrimaryBrush}"
                           FontSize="18"
                           Margin="0,15,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- Items List View -->
        <ScrollViewer Grid.Row="3" 
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="20,10"
                      Visibility="{Binding IsListView, Converter={StaticResource BoolToVisibilityConverter}}">
            <ItemsControl ItemsSource="{Binding DesktopItems}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="#1E2A4A" 
                                CornerRadius="8" 
                                Margin="0,0,0,6" 
                                Padding="12"
                                BorderBrush="{StaticResource HighlightGlowBrush}"
                                BorderThickness="{Binding IsHighlighted, Converter={StaticResource BoolToHighlightThicknessConverter}}"
                                Cursor="Hand">
                            
                            <!-- List View Hover Triggers -->
                            <Border.Triggers>
                                <EventTrigger RoutedEvent="Border.MouseEnter">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="ListOpenBadge"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="1" Duration="0:0:0.15"/>
                                            <ColorAnimation Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                            To="#243A5A" Duration="0:0:0.15"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                                <EventTrigger RoutedEvent="Border.MouseLeave">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="ListOpenBadge"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="0" Duration="0:0:0.15"/>
                                            <ColorAnimation Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                            To="#1E2A4A" Duration="0:0:0.15"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Border.Triggers>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="150"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Icon -->
                                <Image Grid.Column="0" Source="{Binding Icon}" Width="28" Height="28" VerticalAlignment="Center"/>
                                
                                <!-- Name + Badges -->
                                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Name}" 
                                               Foreground="{StaticResource TextPrimaryBrush}" 
                                               FontSize="13"
                                               VerticalAlignment="Center"/>
                                    <Border Visibility="{Binding HasNote, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Background="#4CAF50" CornerRadius="8" Padding="4,1" Margin="8,0,0,0">
                                        <TextBlock Text="ðŸ“" FontSize="10"/>
                                    </Border>
                                    <Border Visibility="{Binding IsHidden, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Background="#9E9E9E" CornerRadius="8" Padding="4,1" Margin="4,0,0,0">
                                        <TextBlock Text="ðŸ‘»" FontSize="10"/>
                                    </Border>
                                    <Border Visibility="{Binding IsLocked, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Background="#FFD700" CornerRadius="8" Padding="4,1" Margin="4,0,0,0">
                                        <TextBlock Text="ðŸ”’" FontSize="10"/>
                                    </Border>
                                    <Border Visibility="{Binding HasCategory, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Background="{Binding CategoryColor}" CornerRadius="8" Padding="4,1" Margin="4,0,0,0"
                                            ToolTip="{Binding CategoryName}">
                                        <TextBlock Text="ðŸ“‚" FontSize="10"/>
                                    </Border>
                                    
                                    <!-- âœ¨ Open Action Badge - Shows on hover in list view âœ¨ -->
                                    <Border x:Name="ListOpenBadge"
                                            Background="#2A5A50"
                                            BorderBrush="#4CAF50"
                                            BorderThickness="1"
                                            CornerRadius="8" 
                                            Padding="6,2" 
                                            Margin="10,0,0,0"
                                            Opacity="0"
                                            ToolTip="{Binding OpenActionHint}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding OpenActionEmoji}" FontSize="10" Margin="0,0,3,0"/>
                                            <TextBlock Text="Open" 
                                                       Foreground="#4CAF50" 
                                                       FontSize="9" 
                                                       FontWeight="Bold"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                                
                                <!-- Type -->
                                <TextBlock Grid.Column="2" 
                                           Text="{Binding FileType}" 
                                           Foreground="#808090" 
                                           FontSize="11"
                                           VerticalAlignment="Center"
                                           Margin="15,0"/>
                                
                                <!-- Size -->
                                <TextBlock Grid.Column="3" 
                                           Text="{Binding FormattedSize}" 
                                           Foreground="#808090" 
                                           FontSize="11"
                                           VerticalAlignment="Center"/>
                                
                                <!-- Date -->
                                <TextBlock Grid.Column="4" 
                                           Text="{Binding DateModified, StringFormat='{}{0:MMM dd, yyyy}'}"
                                           Foreground="#606080" 
                                           FontSize="11"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</Window>
